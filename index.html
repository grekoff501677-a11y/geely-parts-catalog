<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>–ö–∞—Ç–∞–ª–æ–≥ 1TYRES | Damu Auto</title>
<meta name="theme-color" content="#aa8643">
<meta name="msapplication-TileColor" content="#aa8643">

<link rel="icon" type="image/png" href="https://res.cloudinary.com/djjcxxgfm/image/upload/f_png,w_32,h_32,c_fill/v1757929669/%D0%BE%D1%80%D0%B8%D0%B3%D0%B8%D0%BD%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D0%B9_%D1%82%D0%BE%D0%BF%D0%BB%D0%B8%D0%B2%D0%BD%D1%8B%D0%B9_%D1%84%D0%B8%D0%BB%D1%8C%D1%82%D1%80_geely_coolray_okavango_azkarra_%D0%BA%D0%BE%D0%BF%D0%B8%D1%8F_%D0%BA%D0%BE%D0%BF%D0%B8%D1%8F_%D0%BA%D0%BE%D0%BF%D0%B8%D1%8F_9_avfuii.png">
<link rel="preconnect" href="https://res.cloudinary.com" crossorigin>

<style>
  :root{ --bg:#0a1c2b; --card:#0f1d2a; --muted:#9fb2c3; --text:#e9f0f7; --brand:#aa8643; --accent:#aa8643; --danger:#ff6b6b; --border:#1e3040; --chip:#122233; --chip-active:#16283a; --focus:#aa8643; }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--text);font:16px/1.5 system-ui, -apple-system, sans-serif}
  
  /* Header */
  header{position:sticky;top:0;z-index:100;background:rgba(10,28,43,.95);backdrop-filter:blur(10px);border-bottom:1px solid var(--border);padding-bottom:12px}
  .wrap{max-width:1100px;margin:0 auto;padding:0 18px}
  
  /* –õ–æ–≥–æ –∏ –ó–∞–≥–æ–ª–æ–≤–æ–∫ */
  .title{display:flex;flex-direction:column;align-items:center;gap:8px;padding-top:12px}
  .logo{height:50px;width:auto;object-fit:contain}
  h1{margin:0;font-size:20px;letter-spacing:.3px;text-align:center}
  .updated{color:var(--muted);font-size:12px;text-align:center}

  /* –ë–∞–Ω–Ω–µ—Ä –°–∫–∏–¥–∫–∏ (–¶–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω) */
  .club-banner {
    background: linear-gradient(90deg, rgba(170, 134, 67, 0.15) 0%, rgba(10, 28, 43, 0) 100%);
    border: 1px solid rgba(170, 134, 67, 0.3);
    padding: 10px 12px;
    margin: 12px 0;
    font-size: 14px;
    color: #e9f0f7;
    border-radius: 8px;
    text-align: center;
  }
  /* –°—Å—ã–ª–∫–∞ –Ω–∞ –ò–Ω—Å—Ç–∞–≥—Ä–∞–º –∫–ª—É–±–∞ */
  .club-link {
    color: var(--brand);
    font-weight: 800;
    text-decoration: underline;
    transition: 0.2s;
  }
  .club-link:hover {
    color: #fff;
    text-decoration: none;
  }

  /* –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (Flex –¥–ª—è —Ä–∞–∑–º–µ—â–µ–Ω–∏—è –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞ —Å–ø—Ä–∞–≤–∞) */
  .controls-row { display: flex; gap: 12px; align-items: flex-start; justify-content: space-between; margin-bottom: 12px; }
  
  /* –ë–ª–æ–∫ –≤—ã–±–æ—Ä–∞ –º–æ–¥–µ–ª–µ–π */
  .select-group { flex: 1; min-width: 0; }
  .select-label { color:#9ab1c8; font-size:13px; margin-bottom:6px; display:block; }
  
  .chips{display:grid;grid-template-columns:repeat(auto-fit, minmax(100px, 1fr));gap:8px}
  .chip{display:block;text-align:center;user-select:none;padding:8px 10px;border-radius:99px;border:1px solid var(--border);background:var(--chip);color:#c3d7eb;cursor:pointer;font-size:13px; transition:0.2s}
  .chip:hover { border-color: var(--brand); }
  .chip.active{background:var(--brand);border-color:var(--brand);color:#fff;box-shadow:0 0 10px rgba(170,134,67,0.3)}

  /* –ö–Ω–æ–ø–∫–∞ –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞ (–°–ø—Ä–∞–≤–∞) */
  .calc-btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    background: #122233;
    border: 1px dashed var(--brand);
    color: #fff;
    padding: 0 20px;
    height: 74px; /* –í—ã—Å–æ—Ç–∞ –≤—ã—Ä–æ–≤–Ω–µ–Ω–∞ –ø–æ–¥ –±–ª–æ–∫ —á–∏–ø—Å–æ–≤ */
    border-radius: 12px;
    text-decoration: none;
    font-weight: 600;
    transition: all 0.2s;
    white-space: nowrap;
    flex-shrink: 0;
  }
  .calc-btn:hover { background: var(--brand); border-style: solid; color: #000; }
  
  /* –ü–æ–∏—Å–∫ */
  .search-container{display:none;align-items:center;gap:8px; margin-top: 10px;}
  .search-box{position:relative;flex:1;display:flex;align-items:center}
  #searchInput{width:100%;padding:10px 35px 10px 14px;border:1px solid var(--border);border-radius:10px;background:var(--chip);color:var(--text);font-size:14px;outline:none;transition:0.2s}
  #searchInput:focus{border-color:var(--brand);}
  .clear-btn{position:absolute;right:8px;width:20px;height:20px;border:none;border-radius:50%;background:var(--muted);color:var(--bg);cursor:pointer;display:flex;align-items:center;justify-content:center;font-weight:bold;}

  /* –°–µ—Ç–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤ */
  .grid{display:grid;grid-template-columns:repeat( auto-fill, minmax(280px,1fr));gap:14px;margin:20px auto}
  .card{position:relative;background:var(--card);border:1px solid var(--border);border-radius:14px;overflow:hidden;transition:.2s;display:flex;flex-direction:column}
  .card:hover{transform:translateY(-3px);border-color:var(--brand);}
  .imgwrap{aspect-ratio:4/3;background:#0c1322;display:flex;align-items:center;justify-content:center; overflow:hidden;}
  .imgwrap img{max-width:100%;max-height:100%;object-fit:contain}
  
  .content{padding:12px;display:flex;flex-direction:column;flex:1}
  .name{margin:0 0 6px;font-weight:600;font-size:15px;line-height:1.3}
  .desc{margin:0 0 10px;color:var(--muted);font-size:13px}
  .row{display:flex;align-items:center;justify-content:space-between;margin-top:auto}
  .price{font-size:18px;font-weight:700;color:var(--brand)}
  .btn{display:block;width:100%;text-align:center;padding:10px;border-radius:8px;background:var(--border);color:#fff;text-decoration:none;margin-top:10px;font-size:14px;transition:0.2s}
  .btn.primary{background:var(--brand);color:#fff}
  .btn.primary:hover{filter:brightness(1.1)}
  
  .empty{text-align:center;padding:40px;color:var(--muted);border:1px dashed var(--border);border-radius:12px}
  footer{color:#586e85;text-align:center;padding:30px 0;font-size:13px}

  /* –ê–¥–∞–ø—Ç–∏–≤ */
  @media (max-width:700px){
    .title{flex-direction:row;justify-content:center;flex-wrap:wrap}
    
    /* –ù–∞ –º–æ–±–∏–ª—å–Ω–æ–º —Ä–∞–∑–Ω–æ—Å–∏–º –≤ –∫–æ–ª–æ–Ω–∫—É */
    .controls-row { flex-direction: column; gap: 10px; }
    
    .chips { grid-template-columns: repeat(2, 1fr); }
    
    /* –ö–Ω–æ–ø–∫–∞ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —à–∏—Ä–æ–∫–æ–π */
    .calc-btn { 
      width: 100%; 
      height: 48px; 
      margin-top: 5px;
    }
    
    h1 { font-size: 18px; }
    .club-banner { font-size: 13px; padding: 8px; }
  }
</style>
</head>
<body>
  <header>
    <div class="wrap">
      <div class="title">
        <img class="logo" src="https://res.cloudinary.com/djjcxxgfm/image/upload/f_auto,q_auto,h_100/v1757929669/%D0%BE%D1%80%D0%B8%D0%B3%D0%B8%D0%BD%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D0%B9_%D1%82%D0%BE%D0%BF%D0%BB%D0%B8%D0%B2%D0%BD%D1%8B%D0%B9_%D1%84%D0%B8%D0%BB%D1%8C%D1%82%D1%80_geely_coolray_okavango_azkarra_%D0%BA%D0%BE%D0%BF%D0%B8%D1%8F_%D0%BA%D0%BE%D0%BF%D0%B8%D1%8F_%D0%BA%D0%BE%D0%BF%D0%B8%D1%8F_9_avfuii.png" alt="Damu Auto">
        <div>
          <h1>–ö–∞—Ç–∞–ª–æ–≥ 1TYRES | Damu Auto</h1>
          <div class="updated" id="updated"></div>
        </div>
      </div>
      
      <div class="club-banner">
        üî• –î–ª—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ 
        <a href="https://www.instagram.com/geelyclub14pvl/" target="_blank" class="club-link">Geely Club Pavlodar</a> 
        ‚Äî —Å–∫–∏–¥–∫–∞ –Ω–∞ –≤–µ—Å—å –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç!
      </div>

      <div class="controls-row">
        
        <div class="select-group">
          <span class="select-label">–í—ã–±–µ—Ä–∏—Ç–µ –º–æ–¥–µ–ª—å:</span>
          <div class="chips" id="modelChips"></div>
        </div>

        <a href="/regulations.html" class="calc-btn">
          <span style="font-size:20px">üßÆ</span> –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –¢–û
        </a>
      </div>

      <div class="search-container" id="searchContainer">
        <div class="search-box">
          <input type="text" id="searchInput" placeholder="–ü–æ–∏—Å–∫ –∑–∞–ø—á–∞—Å—Ç–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä: —Ñ–∏–ª—å—Ç—Ä)..." autocomplete="off">
          <button type="button" id="clearSearch" class="clear-btn" style="display:none">√ó</button>
        </div>
      </div>
    </div>
  </header>

  <main class="wrap">
    <div id="grid" class="grid"></div>
    <div id="empty" class="empty" style="display:none">–í—ã–±–µ—Ä–∏—Ç–µ –º–æ–¥–µ–ª—å –∞–≤—Ç–æ–º–æ–±–∏–ª—è, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –∫–∞—Ç–∞–ª–æ–≥.</div>
  </main>

  <footer>
    <a href="privacy-policy.html" style="color:inherit;text-decoration:none">–ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏</a>
    <br><br>
    Damu Auto ¬© 2025
  </footer>

<script>
// –ù–∞—Å—Ç—Ä–æ–π–∫–∏
const MODEL_CHIPS = [
  {label:'Monjaro KX11', dbKey:'monjaro', modelKey:'Monjaro'},
  {label:'Coolray (New)', dbKey:'coolray', modelKey:'Coolray'},
  {label:'Okavango (New)', dbKey:'okavango', modelKey:'Okavango'},
  {label:'Atlas FX11', dbKey:'atlas', modelKey:'Atlas'},
];

const state = { activeModel: null, searchQuery: '' };
const db = { atlas: [], monjaro: [], okavango: [], coolray: [], common: [] };

// –≠–ª–µ–º–µ–Ω—Ç—ã
const elGrid = document.getElementById('grid');
const elEmpty = document.getElementById('empty');
const elUpdated = document.getElementById('updated');
const elSearchContainer = document.getElementById('searchContainer');
const elSearchInput = document.getElementById('searchInput');
const elClearSearch = document.getElementById('clearSearch');
const elChips = document.getElementById('modelChips');

elUpdated.textContent = `–û–±–Ω–æ–≤–ª–µ–Ω–æ: ${new Date().toLocaleDateString('ru-RU')}`;

// –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫–∞—Ä—Ç–∏–Ω–æ–∫
function cldUrl(url, w){
  try{
    if(!url || !url.includes('cloudinary.com')) return url;
    return url.replace('/upload/', `/upload/f_auto,q_auto,w_${w}/`);
  }catch(_){ return url; }
}

// –ó–∞–≥—Ä—É–∑–∫–∞
Promise.all([
  fetch('/atlas.json').then(r => r.json()),
  fetch('/monjaro.json').then(r => r.json()),
  fetch('/okavango.json').then(r => r.json()),
  fetch('/coolray.json').then(r => r.json()),
  fetch('/common.json').then(r => r.json())
]).then(([atlas, monjaro, okavango, coolray, common]) => {
  db.atlas = atlas.items || [];
  db.monjaro = monjaro.items || [];
  db.okavango = okavango.items || [];
  db.coolray = coolray.items || [];
  db.common = common.items || [];
  
  // –ü—Ä–æ–≤–µ—Ä–∫–∞ URL –Ω–∞ –Ω–∞–ª–∏—á–∏–µ ?model=...
  const params = new URLSearchParams(window.location.search);
  const urlModel = params.get('model');
  if(urlModel){
    // –ò—â–µ–º —á–∏–ø, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π id –º–æ–¥–µ–ª–∏
    const target = MODEL_CHIPS.find(m => m.dbKey === urlModel);
    if(target) selectModel(target.label);
  } else {
    render(); // –ü–æ–∫–∞–∑–∞—Ç—å –ø—É—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
  }
}).catch(console.error);

// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–Ω–æ–ø–æ–∫
MODEL_CHIPS.forEach(c => {
  const el = document.createElement('span');
  el.className = 'chip';
  el.textContent = c.label;
  el.onclick = () => selectModel(c.label);
  elChips.appendChild(el);
});

function selectModel(label){
  const chips = document.querySelectorAll('.chip');
  let isUnselect = false;

  chips.forEach(chip => {
    if(chip.textContent === label){
      if(chip.classList.contains('active')){
        chip.classList.remove('active');
        state.activeModel = null;
        isUnselect = true;
      } else {
        chip.classList.add('active');
        state.activeModel = label;
      }
    } else {
      chip.classList.remove('active');
    }
  });

  if(isUnselect) {
    elSearchContainer.style.display = 'none';
    state.searchQuery = '';
    elSearchInput.value = '';
  } else {
    elSearchContainer.style.display = 'flex';
  }
  render();
}

// –ü–æ–∏—Å–∫
elSearchInput.oninput = (e) => {
  state.searchQuery = e.target.value.toLowerCase().trim();
  elClearSearch.style.display = state.searchQuery ? 'flex' : 'none';
  render();
};
elClearSearch.onclick = () => {
  state.searchQuery = '';
  elSearchInput.value = '';
  elClearSearch.style.display = 'none';
  render();
};

// –†–µ–Ω–¥–µ—Ä
function getProducts() {
  if (!state.activeModel) return [];
  const config = MODEL_CHIPS.find(c => c.label === state.activeModel);
  if (!config) return [];

  const specific = db[config.dbKey] || [];
  const map = new Map();

  // –û–±—â–∏–µ —Ç–æ–≤–∞—Ä—ã
  db.common.forEach(p => {
    if (p.models && p.models.includes(config.modelKey)) map.set(p.id, { ...p });
  });

  // –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ (–ø–µ—Ä–µ–∫—Ä—ã–≤–∞—é—Ç –æ–±—â–∏–µ)
  specific.forEach(p => {
    const ex = map.get(p.id);
    map.set(p.id, ex ? { ...ex, ...p } : { ...p });
  });

  let res = Array.from(map.values());
  
  if (state.searchQuery) {
    res = res.filter(p => p.name.toLowerCase().includes(state.searchQuery));
  }
  
  return res.sort((a, b) => (a.order || 99) - (b.order || 99));
}

function render(){
  const items = getProducts();
  
  if(!state.activeModel){
    elGrid.innerHTML = '';
    elEmpty.style.display = 'block';
    elEmpty.textContent = '–í—ã–±–µ—Ä–∏—Ç–µ –º–æ–¥–µ–ª—å –∞–≤—Ç–æ–º–æ–±–∏–ª—è –≤—ã—à–µ üëÜ';
    return;
  }

  if(items.length === 0){
    elGrid.innerHTML = '';
    elEmpty.style.display = 'block';
    elEmpty.textContent = '–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ üòî';
    return;
  }

  elEmpty.style.display = 'none';
  elGrid.innerHTML = items.map(p => `
    <article class="card">
      <div class="imgwrap">
        <img src="${cldUrl(p.img || p.imgs?.[0], 400)}" loading="lazy" alt="${p.name}">
      </div>
      <div class="content">
        <h3 class="name">${p.name}</h3>
        <p class="desc">${p.desc || ''}</p>
        <div class="row">
          <div class="price">${p.price ? new Intl.NumberFormat('ru-RU').format(p.price) + ' ‚Ç∏' : '‚Äî'}</div>
        </div>
        <a href="${p.kaspi || '#'}" target="_blank" class="btn ${p.kaspi?'primary':''}">
          ${p.kaspi ? '–ö—É–ø–∏—Ç—å –Ω–∞ Kaspi' : '–°–∫–æ—Ä–æ –≤ –ø—Ä–æ–¥–∞–∂–µ'}
        </a>
      </div>
    </article>
  `).join('');
}
</script>
</body>
</html>
